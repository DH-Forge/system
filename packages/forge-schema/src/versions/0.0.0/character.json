{
   "$schema": "https://json-schema.org/draft/2020-12/schema",
   "type": "object",
   "properties": {
      "_type": {
         "const": "characterDocument"
      },
      "_meta": {
         "type": "object",
         "properties": {
            "rulesetUrl": {
               "type": "string",
               "format": "uri"
            },
            "rulesetVersion": {
               "type": "string",
               "pattern": "^\\d+\\.\\d+\\.\\d+$"
            },
            "dateCreated": {
               "type": "string",
               "format": "date-time",
               "pattern": "^((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))T([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d(\\.\\d+)?(Z)$"
            },
            "dateUpdated": {
               "type": "string",
               "format": "date-time",
               "pattern": "^((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))T([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d(\\.\\d+)?(Z)$"
            }
         },
         "required": [
            "rulesetUrl",
            "rulesetVersion",
            "dateCreated",
            "dateUpdated"
         ],
         "additionalProperties": false
      },
      "name": {
         "type": "string"
      },
      "nameAlternate": {
         "anyOf": [
            {
               "type": "string"
            },
            {
               "type": "null"
            }
         ]
      },
      "pronouns": {
         "type": "object",
         "properties": {
            "_type": {
               "const": "pronouns"
            },
            "subject": {
               "type": "string"
            },
            "object": {
               "type": "string"
            },
            "possessive": {
               "type": "string"
            },
            "reflexive": {
               "type": "string"
            }
         },
         "required": [
            "_type",
            "subject",
            "object",
            "possessive",
            "reflexive"
         ],
         "additionalProperties": false
      },
      "heritage": {
         "type": "object",
         "properties": {
            "_type": {
               "default": "heritage",
               "const": "heritage"
            },
            "community": {
               "type": "object",
               "properties": {
                  "_type": {
                     "const": "reference"
                  },
                  "_key": {
                     "const": "heritage/community"
                  },
                  "value": {
                     "type": "string"
                  }
               },
               "required": [
                  "_type",
                  "_key",
                  "value"
               ],
               "additionalProperties": false
            },
            "ancestry": {
               "anyOf": [
                  {
                     "type": "object",
                     "properties": {
                        "_type": {
                           "default": "singleAncestry",
                           "const": "singleAncestry"
                        },
                        "ancestry": {
                           "$ref": "#/$defs/__schema0"
                        }
                     },
                     "required": [
                        "_type",
                        "ancestry"
                     ],
                     "additionalProperties": false
                  },
                  {
                     "type": "object",
                     "properties": {
                        "_type": {
                           "default": "dualAncestry",
                           "const": "dualAncestry"
                        },
                        "primary": {
                           "$ref": "#/$defs/__schema0"
                        },
                        "secondary": {
                           "$ref": "#/$defs/__schema0"
                        }
                     },
                     "required": [
                        "_type",
                        "primary",
                        "secondary"
                     ],
                     "additionalProperties": false
                  }
               ]
            }
         },
         "required": [
            "_type",
            "community",
            "ancestry"
         ],
         "additionalProperties": false
      },
      "roles": {
         "type": "array",
         "items": {
            "type": "object",
            "properties": {
               "_type": {
                  "default": "characterRole",
                  "const": "characterRole"
               },
               "class": {
                  "type": "object",
                  "properties": {
                     "_type": {
                        "const": "reference"
                     },
                     "_key": {
                        "const": "role/class"
                     },
                     "value": {
                        "type": "string"
                     }
                  },
                  "required": [
                     "_type",
                     "_key",
                     "value"
                  ],
                  "additionalProperties": false
               },
               "subclass": {
                  "type": "object",
                  "properties": {
                     "_type": {
                        "const": "reference"
                     },
                     "_key": {
                        "const": "role/subclass"
                     },
                     "value": {
                        "type": "string"
                     }
                  },
                  "required": [
                     "_type",
                     "_key",
                     "value"
                  ],
                  "additionalProperties": false
               }
            },
            "required": [
               "_type",
               "class",
               "subclass"
            ],
            "additionalProperties": false
         }
      },
      "experiences": {
         "type": "array",
         "items": {
            "type": "object",
            "properties": {
               "_type": {
                  "default": "experience",
                  "const": "experience"
               },
               "name": {
                  "type": "string"
               },
               "description": {
                  "default": null,
                  "anyOf": [
                     {
                        "type": "string"
                     },
                     {
                        "type": "null"
                     }
                  ]
               }
            },
            "required": [
               "_type",
               "name",
               "description"
            ],
            "additionalProperties": false
         }
      },
      "level": {
         "type": "integer",
         "minimum": 1,
         "maximum": 10
      },
      "evasion": {
         "type": "integer",
         "minimum": 0,
         "maximum": 100
      },
      "armorSlots": {
         "$ref": "#/$defs/__schema1"
      },
      "hitPoints": {
         "$ref": "#/$defs/__schema1"
      },
      "damageThresholds": {
         "type": "object",
         "properties": {
            "_type": {
               "default": "damageThresholds",
               "const": "damageThresholds"
            },
            "major": {
               "type": "integer",
               "minimum": 0,
               "maximum": 100
            },
            "severe": {
               "type": "integer",
               "minimum": 0,
               "maximum": 100
            }
         },
         "required": [
            "_type",
            "major",
            "severe"
         ],
         "additionalProperties": false
      },
      "hope": {
         "$ref": "#/$defs/__schema1"
      },
      "stress": {
         "$ref": "#/$defs/__schema1"
      },
      "traits": {
         "type": "object",
         "propertyNames": {
            "anyOf": [
               {
                  "const": "Agility"
               },
               {
                  "const": "Strength"
               },
               {
                  "const": "Finesse"
               },
               {
                  "const": "Instinct"
               },
               {
                  "const": "Presence"
               },
               {
                  "const": "Knowledge"
               }
            ]
         },
         "additionalProperties": {
            "type": "object",
            "properties": {
               "_type": {
                  "default": "trait",
                  "const": "trait"
               },
               "value": {
                  "default": 0,
                  "type": "integer",
                  "minimum": -9007199254740991,
                  "maximum": 9007199254740991
               },
               "locked": {
                  "default": false,
                  "type": "boolean"
               }
            },
            "required": [
               "_type",
               "value",
               "locked"
            ],
            "additionalProperties": false
         }
      },
      "gold": {
         "type": "object",
         "properties": {
            "_type": {
               "const": "gold"
            },
            "handfuls": {
               "default": 0,
               "type": "integer",
               "minimum": -9007199254740991,
               "maximum": 9007199254740991
            },
            "bags": {
               "default": 0,
               "type": "integer",
               "minimum": -9007199254740991,
               "maximum": 9007199254740991
            },
            "chests": {
               "default": 0,
               "type": "integer",
               "minimum": -9007199254740991,
               "maximum": 9007199254740991
            }
         },
         "required": [
            "_type",
            "handfuls",
            "bags",
            "chests"
         ],
         "additionalProperties": false
      },
      "equippedArmor": {
         "type": "object",
         "properties": {
            "primary": {
               "anyOf": [
                  {
                     "$ref": "#/$defs/__schema2"
                  },
                  {
                     "type": "null"
                  }
               ]
            },
            "notes": {
               "anyOf": [
                  {
                     "type": "string"
                  },
                  {
                     "type": "null"
                  }
               ]
            }
         },
         "required": [
            "primary",
            "notes"
         ],
         "additionalProperties": false
      },
      "equippedWeapon": {
         "type": "object",
         "properties": {
            "primary": {
               "anyOf": [
                  {
                     "$ref": "#/$defs/__schema3"
                  },
                  {
                     "type": "null"
                  }
               ]
            },
            "secondary": {
               "anyOf": [
                  {
                     "$ref": "#/$defs/__schema3"
                  },
                  {
                     "type": "null"
                  }
               ]
            },
            "notes": {
               "anyOf": [
                  {
                     "type": "string"
                  },
                  {
                     "type": "null"
                  }
               ]
            }
         },
         "required": [
            "primary",
            "secondary",
            "notes"
         ],
         "additionalProperties": false
      },
      "inventory": {
         "type": "array",
         "items": {
            "anyOf": [
               {
                  "$ref": "#/$defs/__schema2"
               },
               {
                  "$ref": "#/$defs/__schema3"
               },
               {
                  "type": "object",
                  "properties": {
                     "_type": {
                        "const": "reference"
                     },
                     "_key": {
                        "const": "item/special"
                     },
                     "value": {
                        "type": "string"
                     }
                  },
                  "required": [
                     "_type",
                     "_key",
                     "value"
                  ],
                  "additionalProperties": false
               },
               {
                  "type": "object",
                  "properties": {
                     "_type": {
                        "default": "inventoryThing",
                        "const": "inventoryThing"
                     },
                     "name": {
                        "type": "string"
                     },
                     "description": {
                        "anyOf": [
                           {
                              "type": "string"
                           },
                           {
                              "type": "null"
                           }
                        ]
                     }
                  },
                  "required": [
                     "_type",
                     "name",
                     "description"
                  ],
                  "additionalProperties": false
               }
            ]
         }
      }
   },
   "required": [
      "_type",
      "_meta",
      "name",
      "nameAlternate",
      "pronouns",
      "heritage",
      "roles",
      "experiences",
      "level",
      "evasion",
      "armorSlots",
      "hitPoints",
      "damageThresholds",
      "hope",
      "stress",
      "traits",
      "gold",
      "equippedArmor",
      "equippedWeapon",
      "inventory"
   ],
   "additionalProperties": false,
   "$defs": {
      "__schema0": {
         "type": "object",
         "properties": {
            "_type": {
               "const": "reference"
            },
            "_key": {
               "const": "heritage/ancestry"
            },
            "value": {
               "type": "string"
            }
         },
         "required": [
            "_type",
            "_key",
            "value"
         ],
         "additionalProperties": false
      },
      "__schema1": {
         "type": "object",
         "properties": {
            "_type": {
               "const": "dynamicResource"
            },
            "max": {
               "type": "integer",
               "minimum": 0,
               "maximum": 9007199254740991
            },
            "current": {
               "type": "integer",
               "minimum": 0,
               "maximum": 9007199254740991
            }
         },
         "required": [
            "_type",
            "max",
            "current"
         ],
         "additionalProperties": false
      },
      "__schema2": {
         "type": "object",
         "properties": {
            "_type": {
               "const": "reference"
            },
            "_key": {
               "const": "item/armor"
            },
            "value": {
               "type": "string"
            }
         },
         "required": [
            "_type",
            "_key",
            "value"
         ],
         "additionalProperties": false
      },
      "__schema3": {
         "type": "object",
         "properties": {
            "_type": {
               "const": "reference"
            },
            "_key": {
               "const": "item/weapon"
            },
            "value": {
               "type": "string"
            }
         },
         "required": [
            "_type",
            "_key",
            "value"
         ],
         "additionalProperties": false
      }
   }
}